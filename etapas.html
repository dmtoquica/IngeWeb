// WEB DINÁMICA COMPLETA DEL PROYECTO DE INGENIERÍA WEB
// Versión FINAL CORRECTA: SVG ÚNICO Y ESPECÍFICO POR ETAPA (SIN REPETICIONES)
// Stack: React + Tailwind (canvas)

import { useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";

// ====== SVG DIDÁCTICOS ÚNICOS POR ETAPA ======

const SvgProblema = () => (
  <svg viewBox="0 0 420 160" className="w-full border rounded-lg bg-white">
    <text x="210" y="20" textAnchor="middle" fontWeight="bold">Contexto del problema</text>
    <rect x="20" y="60" width="110" height="40" fill="#e5e7eb" />
    <rect x="155" y="45" width="110" height="70" fill="#dbeafe" />
    <rect x="290" y="60" width="110" height="40" fill="#dcfce7" />
    <text x="75" y="85" textAnchor="middle">Entrada</text>
    <text x="210" y="85" textAnchor="middle">Proceso</text>
    <text x="345" y="85" textAnchor="middle">Salida</text>
  </svg>
);

const SvgRequisitos = () => (
  <svg viewBox="0 0 420 160" className="w-full border rounded-lg bg-white">
    <text x="210" y="20" textAnchor="middle" fontWeight="bold">Actor → Funcionalidades</text>
    <circle cx="70" cy="90" r="30" fill="#fde68a" />
    <rect x="130" y="50" width="260" height="80" fill="#f1f5f9" />
    <text x="70" y="95" textAnchor="middle">Actor</text>
    <text x="260" y="95" textAnchor="middle">Requisitos funcionales</text>
  </svg>
);

const SvgArquitectura = () => (
  <svg viewBox="0 0 420 180" className="w-full border rounded-lg bg-white">
    <text x="210" y="20" textAnchor="middle" fontWeight="bold">Arquitectura Web</text>
    <rect x="60" y="40" width="300" height="30" fill="#e0e7ff" />
    <rect x="60" y="80" width="300" height="30" fill="#c7d2fe" />
    <rect x="60" y="120" width="300" height="30" fill="#a5b4fc" />
    <text x="210" y="60" textAnchor="middle">Navegador</text>
    <text x="210" y="100" textAnchor="middle">Frontend (HTML / CSS / JS)</text>
    <text x="210" y="140" textAnchor="middle">Servidor / Datos</text>
  </svg>
);

const SvgWireframe = () => (
  <svg viewBox="0 0 420 200" className="w-full border rounded-lg bg-white">
    <text x="210" y="20" textAnchor="middle" fontWeight="bold">Wireframe</text>
    <rect x="70" y="40" width="280" height="140" fill="none" stroke="#000" />
    <rect x="90" y="60" width="240" height="20" fill="#e5e7eb" />
    <rect x="90" y="95" width="240" height="20" fill="#e5e7eb" />
    <rect x="150" y="135" width="120" height="30" fill="#bfdbfe" />
  </svg>
);

const SvgPrototipo = () => (
  <svg viewBox="0 0 420 200" className="w-full border rounded-lg bg-white">
    <text x="210" y="20" textAnchor="middle" fontWeight="bold">Prototipo Navegable</text>
    <rect x="70" y="40" width="280" height="140" fill="#f8fafc" stroke="#000" />
    <rect x="90" y="60" width="100" height="20" fill="#bae6fd" />
    <rect x="210" y="60" width="120" height="20" fill="#bae6fd" />
    <rect x="150" y="120" width="120" height="30" fill="#86efac" />
    <text x="210" y="140" textAnchor="middle">Click</text>
  </svg>
);

const SvgHTML = () => (
  <svg viewBox="0 0 420 160" className="w-full border rounded-lg bg-white">
    <text x="210" y="20" textAnchor="middle" fontWeight="bold">HTML Semántico</text>
    <rect x="40" y="40" width="340" height="100" fill="#0f172a" />
    <text x="60" y="70" fill="#38bdf8">&lt;header&gt;</text>
    <text x="60" y="95" fill="#38bdf8">&lt;main&gt;</text>
    <text x="60" y="120" fill="#38bdf8">&lt;footer&gt;</text>
  </svg>
);

const SvgCSS = () => (
  <svg viewBox="0 0 420 160" className="w-full border rounded-lg bg-white">
    <text x="210" y="20" textAnchor="middle" fontWeight="bold">Modelo de Caja CSS</text>
    <rect x="110" y="50" width="200" height="60" fill="#bbf7d0" />
    <rect x="130" y="65" width="160" height="30" fill="#dcfce7" />
    <text x="210" y="85" textAnchor="middle">Contenido</text>
  </svg>
);

const SvgJS = () => (
  <svg viewBox="0 0 420 160" className="w-full border rounded-lg bg-white">
    <text x="210" y="20" textAnchor="middle" fontWeight="bold">DOM + Eventos</text>
    <circle cx="210" cy="80" r="30" fill="#fde68a" />
    <line x1="210" y1="110" x2="160" y2="140" stroke="#000" />
    <line x1="210" y1="110" x2="260" y2="140" stroke="#000" />
    <text x="210" y="85" textAnchor="middle">DOM</text>
  </svg>
);

const SvgTesting = () => (
  <svg viewBox="0 0 420 160" className="w-full border rounded-lg bg-white">
    <text x="210" y="20" textAnchor="middle" fontWeight="bold">Pruebas de Software</text>
    <rect x="170" y="40" width="80" height="25" fill="#fecaca" />
    <rect x="140" y="75" width="140" height="25" fill="#fde68a" />
    <rect x="110" y="110" width="200" height="25" fill="#bbf7d0" />
    <text x="210" y="58" textAnchor="middle">Unitarias</text>
    <text x="210" y="93" textAnchor="middle">Integración</text>
    <text x="210" y="128" textAnchor="middle">Sistema</text>
  </svg>
);

const SvgFinal = () => (
  <svg viewBox="0 0 420 160" className="w-full border rounded-lg bg-white">
    <text x="210" y="20" textAnchor="middle" fontWeight="bold">Sistema Final</text>
    <rect x="60" y="50" width="300" height="70" fill="#e0f2fe" />
    <text x="210" y="90" textAnchor="middle">Aplicación Web Completa</text>
  </svg>
);

export default function ProyectoIngenieriaWeb() {
  const [etapa, setEtapa] = useState(1);

  const etapas = [
    { id: 1, titulo: "Etapa 1 · Análisis del problema", imagen: <SvgProblema />, items: ["Problema real", "Usuario", "Entrada–Proceso–Salida", "Alcance"] },
    { id: 2, titulo: "Etapa 2 · Requisitos", imagen: <SvgRequisitos />, items: ["Requisitos funcionales", "No funcionales", "Actores"] },
    { id: 3, titulo: "Etapa 3 · Arquitectura", imagen: <SvgArquitectura />, items: ["Cliente–servidor", "Capas", "Flujo técnico"] },
    { id: 4, titulo: "Etapa 4 · Wireframes", imagen: <SvgWireframe />, items: ["Pantallas", "Navegación", "Jerarquía"] },
    { id: 5, titulo: "Etapa 5 · Prototipo", imagen: <SvgPrototipo />, items: ["Clickeable", "Flujos validados"] },
    { id: 6, titulo: "Etapa 6 · HTML", imagen: <SvgHTML />, items: ["HTML5", "Semántica"] },
    { id: 7, titulo: "Etapa 7 · CSS", imagen: <SvgCSS />, items: ["Layout", "Responsive"] },
    { id: 8, titulo: "Etapa 8 · JavaScript", imagen: <SvgJS />, items: ["Eventos", "DOM", "Validaciones"] },
    { id: 9, titulo: "Etapa 9 · Pruebas", imagen: <SvgTesting />, items: ["Casos de prueba", "Correcciones"] },
    { id: 10, titulo: "Etapa 10 · Producto final", imagen: <SvgFinal />, items: ["Sistema funcional", "Sustentación"] }
  ];

  const actual = etapas.find(e => e.id === etapa);

  return (
    <div className="p-6 max-w-6xl mx-auto">
      <h1 className="text-3xl font-bold mb-4">Proyecto de Ingeniería Web – Desarrollo por Etapas</h1>
      <div className="grid grid-cols-2 md:grid-cols-5 gap-3 mb-6">
        {etapas.map(e => (
          <Button key={e.id} variant={e.id === etapa ? "default" : "outline"} onClick={() => setEtapa(e.id)}>
            Etapa {e.id}
          </Button>
        ))}
      </div>
      <Card className="shadow-xl">
        <CardContent className="p-6 space-y-4">
          <h2 className="text-xl font-semibold">{actual.titulo}</h2>
          {actual.imagen}
          <ul className="list-disc pl-6 space-y-2">
            {actual.items.map((i, idx) => <li key={idx}>{i}</li>)}
          </ul>
        </CardContent>
      </Card>
    </div>
  );
}
